<?xml version="1.0" encoding="UTF-8"?>
<ModuleDependencies Name="AcfPublic" Version="FlavorOfTheDay">

	<Targets>
		<Target Default="True" Language="CPP" Name="AcfPublic"/>
		<Target Language="CPP" Name="Acf"/>
		<Target Language="CPP" Name="AcfSln"/>
		<Target Language="CPP" Name="MakeProjects"/>
		<!-- Targets for Visual Studio 2013 builds-->
		<Target Language="CPP" Name="AcfPublic2013"/>
		<Target Language="CPP" Name="Acf2013"/>
		<Target Language="CPP" Name="AcfSln2103"/>
		<Target Language="CPP" Name="MakeProjects2013"/>
	</Targets>

	<Dependencies>
		<Dependency>
			<Module Name="QtLibraries"/>
		</Dependency>
		<Dependency IfTarget="AcfSln">
			<Module Name="AcfPublic" Target="Acf"/>
		</Dependency>
		<Dependency IfTarget="AcfPublic">
			<Module Name="AcfPublic" Target="Acf"/>
			<Module Name="AcfPublic" Target="AcfSln"/>
		</Dependency>
		<Dependency IfTarget="AcfSln2013">
			<Module Name="AcfPublic" Target="Acf2013"/>
		</Dependency>
		<Dependency IfTarget="AcfPublic2013">
			<Module Name="AcfPublic" Target="Acf2013"/>
			<Module Name="AcfPublic" Target="AcfSln2013"/>
		</Dependency>
	</Dependencies>

	<Builds>
		<!-- generates solution -->
		<Build IfTarget="MakeProjects">
			<QMakeToVisualStudio Project="Acf/Build/QMake/AcfAll.pro" VisualStudioVersion="2010"/>
			<QMakeToVisualStudio Project="AcfSln/Build/QMake/AcfSlnAll.pro" VisualStudioVersion="2010"/>
		</Build>
		<Build IfTarget="MakeProjects2013">
			<QMakeToVisualStudio Project="Acf/Build/QMake/AcfAll.pro" VisualStudioVersion="2013" Version="5.2"/>
			<QMakeToVisualStudio Project="AcfSln/Build/QMake/AcfSlnAll.pro" VisualStudioVersion="2013" Version="5.2"/>
		</Build>

		<!-- Build for ACF -->
		<Build IfTarget="Acf">
			<Build IfPlatform="WinOS">
				<QMakeToMakefile Project="Acf/Build/QMake/AcfAll.pro" VisualStudioVersion="2010"/>
				<NMake Makefile="Acf/Build/QMake/Makefile" Version="2010">
					<EnvironmentVariable Name="ACFDIR" Value="$BUILD_PRODUCT_FOLDER\3rdParty\AcfPublic\Acf"/>
					<EnvironmentVariable Name="QTDIR" Value="$CONFIG_QTDIR_WINOS"/>
					<EnvironmentVariable Name="PATH" Value="%PATH%;$CONFIG_QTDIR_WINOS\Bin"/>
				</NMake>
			</Build>
			<Build IfPlatform="MacOS">
				<QMakeToMakefile Project="Acf/Build/QMake/AcfAll.pro"/>
				<Make Makefile="Acf/Build/QMake/Makefile" Version="1">
					<EnvironmentVariable Name="ACFDIR" Value="$BUILD_PRODUCT_FOLDER/3rdParty/AcfPublic/Acf"/>
					<EnvironmentVariable Name="QTDIR" Value="$CONFIG_QTDIR_MACOS"/>
					<EnvironmentVariable Name="PATH" Value="$PATH:$CONFIG_QTDIR_MACOS/Bin"/>
				</Make>
			</Build>
		</Build>
		
		<!-- Build for AcfSln -->
		<Build IfTarget="AcfSln">
			<Build IfPlatform="WinOS">
				<QMakeToMakefile Project="AcfSln/Build/QMake/AcfSlnAll.pro" VisualStudioVersion="2010"/>
				<NMake Makefile="AcfSln/Build/QMake/Makefile" Version="2010">
					<EnvironmentVariable Name="ACFDIR" Value="$BUILD_PRODUCT_FOLDER\3rdParty\AcfPublic\Acf"/>
					<EnvironmentVariable Name="ACFSLNDIR" Value="$BUILD_PRODUCT_FOLDER\3rdParty\AcfPublic\AcfSln"/>
					<EnvironmentVariable Name="QTDIR" Value="$CONFIG_QTDIR_WINOS"/>
					<EnvironmentVariable Name="PATH" Value="%PATH%;$CONFIG_QTDIR_WINOS\Bin"/>
				</NMake>/>
			</Build>
			<Build IfPlatform="MacOS">
				<QMakeToMakefile Project="AcfSln/Build/QMake/AcfSlnAll.pro"/>
				<Make Makefile="AcfSln/Build/QMake/Makefile" Version="1">
					<EnvironmentVariable Name="ACFDIR" Value="$BUILD_PRODUCT_FOLDER/3rdParty/AcfPublic/Acf"/>
					<EnvironmentVariable Name="ACFSLNDIR" Value="$BUILD_PRODUCT_FOLDER/3rdParty/AcfPublic/AcfSln"/>
					<EnvironmentVariable Name="QTDIR" Value="$CONFIG_QTDIR_MACOS"/>
					<EnvironmentVariable Name="PATH" Value="$PATH:$CONFIG_QTDIR_MACOS/Bin"/>
				</Make>
			</Build>
		</Build>

		<Build IfTarget="Acf2013">
			<Build IfPlatform="WinOS">
				<QMakeToMakefile Project="Acf/Build/QMake/AcfAll.pro" VisualStudioVersion="2013" Version="5.2" ShadowBuildFolder="$BUILD_MODULE_TEMP_FOLDER/Acf/Build/QMake/"/>
				<NMake Makefile="Acf/Build/QMake/Makefile" Version="2013" WorkingDirectory="$BUILD_MODULE_TEMP_FOLDER/">
					<!--assume Qt shadow build-->
					<EnvironmentVariable Name="QTDIR" Value="$BUILD_TEMP_FOLDER\QtLibraries\qtbase"/>
					<EnvironmentVariable Name="PATH" Value="%PATH%;$BUILD_TEMP_FOLDER\QtLibraries\qtbase\bin"/>
				</NMake>
			</Build>
			<!-- shadow build for OSX -->
			<Build IfPlatform="MacOS">
				<QMakeToMakefile Project="Acf/Build/QMake/AcfAll.pro" Version="5.2" ShadowBuildFolder="$BUILD_MODULE_TEMP_FOLDER/Acf/Build/QMake/"/>
				<Make WorkingDirectory="$BUILD_MODULE_TEMP_FOLDER/Acf/Build/QMake/"/>
			</Build>
			<!-- non shadow build for OSX -->
			<!--
			<Build IfPlatform="MacOS">
				<QMakeToMakefile Project="Acf/Build/QMake/AcfAll.pro" Version="5.2"/>
				<Make Makefile="Acf/Build/QMake/Makefile" Version="1">
					<EnvironmentVariable Name="ACFDIR" Value="$BUILD_PRODUCT_FOLDER/3rdParty/AcfPublic/Acf"/>
				</Make>
			</Build>
			-->
		</Build>
		
		<Build IfTarget="AcfSln2013">
			<Build IfPlatform="WinOS">
				<QMakeToMakefile Project="AcfSln/Build/QMake/AcfSlnAll.pro" VisualStudioVersion="2013"  Version="5.2" ShadowBuildFolder="$BUILD_MODULE_TEMP_FOLDER/AcfSln/Build/QMake/"/>
				<NMake Makefile="AcfSln/Build/QMake/Makefile" Version="2013"  WorkingDirectory="$BUILD_MODULE_TEMP_FOLDER/">
					<EnvironmentVariable Name="ACFDIR" Value="$BUILD_PRODUCT_FOLDER\3rdParty\AcfPublic\Acf"/>
					<!--assume Qt shadow build-->
					<EnvironmentVariable Name="QTDIR" Value="$BUILD_TEMP_FOLDER\QtLibraries\qtbase"/>
					<EnvironmentVariable Name="PATH" Value="%PATH%;$BUILD_TEMP_FOLDER\QtLibraries\qtbase\bin"/>
					<EnvironmentVariable Name="ACFDIR" Value="$BUILD_PRODUCT_FOLDER/3rdParty/AcfPublic/Acf"/>
					<EnvironmentVariable Name="ACFDIR_BUILD" Value="$BUILD_MODULE_TEMP_FOLDER/Acf"/>
					<EnvironmentVariable Name="ACFSLNDIR_BUILD" Value="$BUILD_MODULE_TEMP_FOLDER/AcfSln"/>
				</NMake>/>
			</Build>
			<!-- shadow build for OSX -->
			<Build IfPlatform="MacOS">
				<QMakeToMakefile Project="AcfSln/Build/QMake/AcfSlnAll.pro" Version="5.2" ShadowBuildFolder="$BUILD_MODULE_TEMP_FOLDER/AcfSln/Build/QMake/">
					<EnvironmentVariable Name="ACFDIR_BUILD" Value="$BUILD_MODULE_TEMP_FOLDER/Acf"/>
				</QMakeToMakefile>
				<Make WorkingDirectory="$BUILD_MODULE_TEMP_FOLDER/AcfSln/Build/QMake/">
					<EnvironmentVariable Name="ACFDIR" Value="$BUILD_PRODUCT_FOLDER/3rdParty/AcfPublic/Acf"/>
					<EnvironmentVariable Name="ACFDIR_BUILD" Value="$BUILD_MODULE_TEMP_FOLDER/Acf"/>
					<EnvironmentVariable Name="ACFSLNDIR_BUILD" Value="$BUILD_MODULE_TEMP_FOLDER/AcfSln"/>
				</Make>
			</Build>
			<!-- non shadow build for OSX -->
			<!--
			<Build IfPlatform="MacOS">
				<QMakeToMakefile Project="AcfSln/Build/QMake/AcfSlnAll.pro" Version="5.2"/>
				<Make Makefile="AcfSln/Build/QMake/Makefile" Version="1">
					<EnvironmentVariable Name="ACFDIR" Value="$BUILD_PRODUCT_FOLDER/3rdParty/AcfPublic/Acf"/>
				</Make>
			</Build>
			 -->
		</Build>

		<!--Copy QT binaries to ACF bin-->
		<Build IfTarget="AcfPublic">
			<Build IfPlatform="WinOS">
				<Build IfConfiguration="Debug">
					<CopyFile From="$CONFIG_QTDIR_WINOS/bin" FromSelector="QtCored4.dll" To="$ModuleRoot/Acf/Bin/DebugVC10"/>
					<CopyFile From="$CONFIG_QTDIR_WINOS/bin" FromSelector="QtGuid4.dll" To="$ModuleRoot/Acf/Bin/DebugVC10"/>
				</Build>
				<Build IfConfiguration="Release">
					<CopyFile From="$CONFIG_QTDIR_WINOS/bin" FromSelector="QtCore4.dll" To="$ModuleRoot/Acf/Bin/ReleaseVC10"/>
					<CopyFile From="$CONFIG_QTDIR_WINOS/bin" FromSelector="QtGui4.dll" To="$ModuleRoot/Acf/Bin/ReleaseVC10"/>
				</Build>
			</Build>
		</Build>
		<Build IfTarget="AcfPublic2013">
			<Build IfPlatform="WinOS">
				<Build IfConfiguration="Debug">
					<CopyFile From="$BUILD_TEMP_FOLDER\QtLibraries\qtbase\bin" FromSelector="Qt5Cored.dll" To="$BUILD_MODULE_TEMP_FOLDER/Acf/Bin/DebugVC12"/>
          <CopyFile From="$BUILD_TEMP_FOLDER\QtLibraries\qtbase\bin" FromSelector="Qt5Guid.dll" To="$BUILD_MODULE_TEMP_FOLDER/Acf/Bin/DebugVC12"/>
          <CopyFile From="$BUILD_TEMP_FOLDER\QtLibraries\qtbase\bin" FromSelector="Qt5Widgetsd.dll" To="$BUILD_MODULE_TEMP_FOLDER/Acf/Bin/DebugVC12"/>
        </Build>
				<Build IfConfiguration="Release">
					<CopyFile From="$BUILD_TEMP_FOLDER\QtLibraries\qtbase\bin" FromSelector="Qt5Core.dll" To="$BUILD_MODULE_TEMP_FOLDER/Acf/Bin/ReleaseVC12"/>
          <CopyFile From="$BUILD_TEMP_FOLDER\QtLibraries\qtbase\bin" FromSelector="Qt5Gui.dll" To="$BUILD_MODULE_TEMP_FOLDER/Acf/Bin/ReleaseVC12"/>
          <CopyFile From="$BUILD_TEMP_FOLDER\QtLibraries\qtbase\bin" FromSelector="Qt5Widgets.dll" To="$BUILD_MODULE_TEMP_FOLDER/Acf/Bin/ReleaseVC12"/>
        </Build>
			</Build>
		</Build>

	</Builds>

</ModuleDependencies>
